<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ - Sneaker Shop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .nav-links {
            margin-top: 1rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            margin: 0 1rem;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .nav-links a:hover {
            background: rgba(255,255,255,0.2);
        }

        .filters-section {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .filter-group input, .filter-group select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-success {
            background: #28a745;
        }

        .stats-section {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            text-align: center;
        }

        .stat-item {
            padding: 1rem;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .product-image {
            height: 200px;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #999;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-brand {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .product-price {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .product-status {
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: inline-block;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .stars {
            color: #ffc107;
        }

        .rating-text {
            color: #666;
            font-size: 0.9rem;
        }

        .product-actions {
            display: flex;
            gap: 0.5rem;
        }

        .product-actions .btn {
            flex: 1;
            font-size: 0.9rem;
            padding: 0.5rem;
        }

        .pagination a, .pagination span {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-decoration: none;
            color: #333;
            transition: background 0.3s;
        }

        .pagination a:hover {
            background: #f8f9fa;
        }

        .pagination .current {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .no-products {
            text-align: center;
            padding: 3rem;
            color: #666;
            font-style: italic;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .messages {
            margin-bottom: 1rem;
        }

        .alert {
            padding: 0.75rem;
            border-radius: 5px;
            margin-bottom: 0.5rem;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .product-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>üëü –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h1>
            <p>–ù–∞–π–¥–∏—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏ –¥–ª—è —Å–µ–±—è</p>
            <div class="nav-links">
                <a href="{% url 'home' %}">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                {% if user.is_authenticated %}
                    <a href="{% url 'profile' %}">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
                    <a href="{% url 'wishlist' %}">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
                    {% if user.is_staff %}
                        <a href="{% url 'product_create' %}">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
                    {% endif %}
                    <a href="{% url 'logout' %}">üö™ –í—ã–π—Ç–∏</a>
                {% else %}
                    <a href="{% url 'login' %}">üîë –í–æ–π—Ç–∏</a>
                    <a href="{% url 'register' %}">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                {% endif %}
            </div>
        </div>
    </header>

    <div class="container">
        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="filters-section">
            <h3>üîç –§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫</h3>
            <form method="get" action="{% url 'product_list' %}">
                <div class="filters-grid">
                    <div class="filter-group">
                        <label for="search">–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–±—Ä–µ–Ω–¥—É:</label>
                        <input type="text" id="search" name="search" value="{{ request.GET.search }}" 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –±—Ä–µ–Ω–¥...">
                    </div>
                    
                    <div class="filter-group">
                        <label for="brand">–ë—Ä–µ–Ω–¥:</label>
                        <select id="brand" name="brand">
                            <option value="">–í—Å–µ –±—Ä–µ–Ω–¥—ã</option>
                            {% for brand in brands %}
                                <option value="{{ brand }}" {% if request.GET.brand == brand %}selected{% endif %}>
                                    {{ brand }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="price_min">–¶–µ–Ω–∞ –æ—Ç:</label>
                        <input type="number" id="price_min" name="price_min" value="{{ request.GET.price_min }}" 
                               placeholder="0" min="0" step="100">
                    </div>
                    
                    <div class="filter-group">
                        <label for="price_max">–¶–µ–Ω–∞ –¥–æ:</label>
                        <input type="number" id="price_max" name="price_max" value="{{ request.GET.price_max }}" 
                               placeholder="100000" min="0" step="100">
                    </div>
                    
                    <div class="filter-group">
                        <label for="sort">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                        <select id="sort" name="sort">
                            <option value="-created_at" {% if request.GET.sort == '-created_at' %}selected{% endif %}>
                                –°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ
                            </option>
                            <option value="created_at" {% if request.GET.sort == 'created_at' %}selected{% endif %}>
                                –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ
                            </option>
                            <option value="price" {% if request.GET.sort == 'price' %}selected{% endif %}>
                                –ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Ü–µ–Ω—ã
                            </option>
                            <option value="-price" {% if request.GET.sort == '-price' %}selected{% endif %}>
                                –ü–æ —É–±—ã–≤–∞–Ω–∏—é —Ü–µ–Ω—ã
                            </option>
                            <option value="brand" {% if request.GET.sort == 'brand' %}selected{% endif %}>
                                –ü–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (–±—Ä–µ–Ω–¥)
                            </option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <button type="submit" class="btn">üîç –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                    </div>
                    
                    <div class="filter-group">
                        <a href="{% url 'product_list' %}" class="btn btn-secondary">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</a>
                    </div>
                </div>
            </form>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        {% if stats %}
        <div class="stats-section">
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-number">{{ stats.total_products }}</span>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ stats.avg_price|floatformat:0 }}</span>
                    <div class="stat-label">–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ (‚ÇΩ)</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ stats.min_price|floatformat:0 }}</span>
                    <div class="stat-label">–ú–∏–Ω. —Ü–µ–Ω–∞ (‚ÇΩ)</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ stats.max_price|floatformat:0 }}</span>
                    <div class="stat-label">–ú–∞–∫—Å. —Ü–µ–Ω–∞ (‚ÇΩ)</div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
        {% if request.GET.search or request.GET.brand or request.GET.price_min or request.GET.price_max %}
        <div style="background: white; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h4>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:</h4>
            <p>
                –ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: <strong>{{ products.paginator.count }}</strong>
                {% if request.GET.search %}
                    | –ü–æ–∏—Å–∫: "<strong>{{ request.GET.search }}</strong>"
                {% endif %}
                {% if request.GET.brand %}
                    | –ë—Ä–µ–Ω–¥: <strong>{{ request.GET.brand }}</strong>
                {% endif %}
                {% if request.GET.price_min %}
                    | –¶–µ–Ω–∞ –æ—Ç: <strong>{{ request.GET.price_min }} ‚ÇΩ</strong>
                {% endif %}
                {% if request.GET.price_max %}
                    | –¶–µ–Ω–∞ –¥–æ: <strong>{{ request.GET.price_max }} ‚ÇΩ</strong>
                {% endif %}
            </p>
        </div>
        {% endif %}

        <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
        {% if products %}
            <div class="products-grid">
                {% for product in products %}
                    <div class="product-card">
                        <div class="product-image">
                            {% if product.image %}
                                <img src="{{ product.image.url }}" alt="{{ product.brand }}" 
                                     style="width: 100%; height: 100%; object-fit: cover;">
                            {% else %}
                                üëü
                            {% endif %}
                        </div>
                        <div class="product-info">
                            <div class="product-brand">{{ product.brand }}</div>
                            <div class="product-price">{{ product.price|floatformat:0 }} ‚ÇΩ</div>
                            
                            <div class="product-status {% if product.is_active %}status-active{% else %}status-inactive{% endif %}">
                                {% if product.is_active %}
                                    ‚úÖ –í –Ω–∞–ª–∏—á–∏–∏
                                {% else %}
                                    ‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
                                {% endif %}
                            </div>

                            {% if product.avg_rating %}
                                <div class="product-rating">
                                    <span class="stars">
                                        {% for i in "12345" %}
                                            {% if forloop.counter <= product.avg_rating %}‚≠ê{% else %}‚òÜ{% endif %}
                                        {% endfor %}
                                    </span>
                                    <span class="rating-text">
                                        {{ product.avg_rating|floatformat:1 }} ({{ product.review_count }} –æ—Ç–∑—ã–≤–æ–≤)
                                    </span>
                                </div>
                            {% endif %}

                            <div style="margin-bottom: 1rem; color: #666; font-size: 0.9rem;">
                                –î–æ–±–∞–≤–ª–µ–Ω: {{ product.created_at|date:"d.m.Y" }}
                            </div>

                            <div class="product-actions">
                                <a href="{% url 'product_detail' product.sneakers_id %}" class="btn">
                                    üëÅÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                </a>
                                
                                {% if user.is_authenticated %}
                                    <form method="post" action="{% url 'toggle_wishlist' product.sneakers_id %}" style="flex: 1;">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-success" style="width: 100%;">
                                            ‚ù§Ô∏è
                                        </button>
                                    </form>
                                {% endif %}
                                
                                {% if user.is_staff %}
                                    <a href="{% url 'product_edit' product.sneakers_id %}" class="btn btn-secondary">
                                        ‚úèÔ∏è
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
            {% if products.has_other_pages %}
                <div class="pagination">
                    {% if products.has_previous %}
                        <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page=1">¬´ –ü–µ—Ä–≤–∞—è</a>
                        <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ products.previous_page_number }}">‚Äπ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
                    {% endif %}

                    <span class="current">
                        –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ products.number }} –∏–∑ {{ products.paginator.num_pages }}
                    </span>

                    {% if products.has_next %}
                        <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ products.next_page_number }}">–°–ª–µ–¥—É—é—â–∞—è ‚Ä∫</a>
                        <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ products.paginator.num_pages }}">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</a>
                    {% endif %}
                </div>
            {% endif %}
        {% else %}
            <div class="no-products">
                <h3>üòî –¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ <a href="{% url 'product_list' %}">—Å–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a></p>
                {% if user.is_staff %}
                    <div style="margin-top: 1rem;">
                        <a href="{% url 'product_create' %}" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä</a>
                    </div>
                {% endif %}
            </div>
        {% endif %}
    </div>
</body>
</html>